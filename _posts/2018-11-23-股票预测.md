---
layout:     post
title:      基于LSTM的股票预测
subtitle:  
date:       2018-11-23
author:     高庆东
header-img: img/ceshi.jpg
catalog: true
tags:
    - 损失函数
    - python
    - LSTM
    
---

## 问题分析

### 分类
作为分类问题如果预测涨但是涨了0.1，但是某次预测涨结果跌了0.9，这一次的预测失误导致全部赔光了。

这样是不可以接受的，作为分类问题很难考虑到涨跌的实际值是多少。

### 回归
作为回归问题如果预测股票的走势，在理论上是可行的但是，当预测为某个值时，此时实际值要高于这个值

这样的结果是可以接受的，因为相当于多赚了，但是电脑认为实际值与预测值有差距所以会因为这个调整参数

矛盾出来了，此时人可以接受但是机器不接受。如果实际值比预测值低很多此时人不接受，机器对待这两种

情况是一个态度，都会强烈的调整参数。作为回归问题也是不合适的。

## 网络结构

首先是一个rnn网络，输入是30天的数据每天的数据是当天股票的情况，这个情况下有若干个特征，输入是

一个矩阵，输出取网络的最后一个输出作为输出。

## 损失函数

一个新的损失函数是必须的，目的是最大化钱，考虑如何投资才能使钱最多，这个问题是资金分配问题

加入你要买这只股票，你应该投入多少钱去买这只股票呢，最终的输出是分配的比例

loss=p(r-c),

p表示你投钱的比例，r表示当天的股票波动率，c表示用p钱因为没有存银行导致没收到的利率。

新的损失函数只考虑人最关心的资金问题，可以和机器同心。

# 我的拙见
首先股票是一个二阶混沌系统，影响他的因素不仅有外界的环境，它自身也会影响自己，假如一个人知道了

股票的涨跌情况那他就会去买卖，他只要买卖就会影响股票的价格，导致预测的不准确，所以我觉得不可能

存在预测股票的能力，因为混沌系统无法预测。无数的猴子无数的打印机，猴子也无法打出莎士比亚的诗。23333




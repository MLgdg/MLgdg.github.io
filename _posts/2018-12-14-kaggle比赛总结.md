<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE en-export SYSTEM "http://xml.evernote.com/pub/evernote-export3.dtd">
<en-export export-date="20181217T111530Z" application="Evernote" version="Evernote Mac 8.3.2 (457480)">
<note><title>2018-12-14-kaggle比赛总结.md</title><content><![CDATA[<!DOCTYPE en-note SYSTEM 'http://xml.evernote.com/pub/enml2.dtd'><en-note><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">layout:     post<br/>
title:      kaggle竞赛总结分析（没有取得很好的名次）<br/>
subtitle:<br/>
date:       2018-12-14<br/>
author:     高庆东<br/>
header-img: img/ceshi.jpg<br/>
catalog: true<br/>
tags:<br/>
- python<br/>
- 特征工程<br/>
- 数据分解<br/>
- 回归</p>
<hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/>
<h1 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 41px; border-bottom: 3px double #999; color: #000; margin-top: 14px;">微软恶意攻击预测</h1>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">微软的一个数据集给出电脑的特征信息包括编号版本等给出是否受攻击的标签，</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">通过这些数据训练一个模型可以预测电脑是否会收到攻击。这是题目要求，</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">评判标准是Roc曲线面积，输出类别概率。</p>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">记录我敲代码和思路过程和总结</h2>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">首先正对数据集第一步要做的事对数据进行分析，也就是特征工程，分析数据的</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">时候发现数据中有很大一部分标签量，型号量等，这些量必须经过编码转化，才</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">能让模型识别，数据中有很多空值我选择填充方法是用均值来填，（试了其他的</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">都表现一般吧）。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">模型我选择了罗辑回归，回归有两个参数一个是训练算法一个是正则化系数，</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">我选择梯度下降算法正则系数是1（不是很理想的系数）</p>
<h1 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 41px; border-bottom: 3px double #999; color: #000;">上代码</h1>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">以下是我的代码，代码有点糙训练大概需要一个小时左右，我看了排名第一的</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">Roc值是69%，我的ROc是65%有差距，</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">注释很详细</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">def reduce_mem_usage(df, verbose=True):#内存优化函数
    numerics = ['int16', 'int32', 'int64', 'float16', 'float32', 'float64']
    start_mem = df.memory_usage().sum() / 1024**2
    for col in df.columns:
        col_type = df[col].dtypes
        if col_type in numerics:
            c_min = df[col].min()
            c_max = df[col].max()
            if str(col_type)[:3] == 'int':
                if c_min &gt; np.iinfo(np.int8).min and c_max &lt; np.iinfo(np.int8).max:
                    df[col] = df[col].astype(np.int8)
                elif c_min &gt; np.iinfo(np.int16).min and c_max &lt; np.iinfo(np.int16).max:
                    df[col] = df[col].astype(np.int16)
                elif c_min &gt; np.iinfo(np.int32).min and c_max &lt; np.iinfo(np.int32).max:
                    df[col] = df[col].astype(np.int32)
                elif c_min &gt; np.iinfo(np.int64).min and c_max &lt; np.iinfo(np.int64).max:
                    df[col] = df[col].astype(np.int64)
            else:
                if c_min &gt; np.finfo(np.float16).min and c_max &lt; np.finfo(np.float16).max:
                    df[col] = df[col].astype(np.float16)
                elif c_min &gt; np.finfo(np.float32).min and c_max &lt; np.finfo(np.float32).max:
                    df[col] = df[col].astype(np.float32)
                else:
                    df[col] = df[col].astype(np.float64)
    end_mem = df.memory_usage().sum() / 1024**2
    if verbose: print('Mem. usage decreased to {:5.2f} Mb ({:.1f}% reduction)'.format(end_mem, 100 * (start_mem - end_mem) / start_mem))
    return df



import pandas as pd
from sklearn.linear_model import LogisticRegression
import numpy as np
from sklearn.cross_validation import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.preprocessing import Imputer


dtypes = {
        'MachineIdentifier':                                    'category',
        'ProductName':                                          'category',
        'EngineVersion':                                        'category',
        'AppVersion':                                           'category',
        'AvSigVersion':                                         'category',
        'IsBeta':                                               'int8',
        'RtpStateBitfield':                                     'float16',
        'IsSxsPassiveMode':                                     'int8',
        'DefaultBrowsersIdentifier':                            'float16',
        'AVProductStatesIdentifier':                            'float32',
        'AVProductsInstalled':                                  'float16',
        'AVProductsEnabled':                                    'float16',
        'HasTpm':                                               'int8',
        'CountryIdentifier':                                    'int16',
        'CityIdentifier':                                       'float32',
        'OrganizationIdentifier':                               'float16',
        'GeoNameIdentifier':                                    'float16',
        'LocaleEnglishNameIdentifier':                          'int8',
        'Platform':                                             'category',
        'Processor':                                            'category',
        'OsVer':                                                'category',
        'OsBuild':                                              'int16',
        'OsSuite':                                              'int16',
        'OsPlatformSubRelease':                                 'category',
        'OsBuildLab':                                           'category',
        'SkuEdition':                                           'category',
        'IsProtected':                                          'float16',
        'AutoSampleOptIn':                                      'int8',
        'PuaMode':                                              'category',
        'SMode':                                                'float16',
        'IeVerIdentifier':                                      'float16',
        'SmartScreen':                                          'category',
        'Firewall':                                             'float16',
        'UacLuaenable':                                         'float32',
        'Census_MDC2FormFactor':                                'category',
        'Census_DeviceFamily':                                  'category',
        'Census_OEMNameIdentifier':                             'float16',
        'Census_OEMModelIdentifier':                            'float32',
        'Census_ProcessorCoreCount':                            'float16',
        'Census_ProcessorManufacturerIdentifier':               'float16',
        'Census_ProcessorModelIdentifier':                      'float16',
        'Census_ProcessorClass':                                'category',
        'Census_PrimaryDiskTotalCapacity':                      'float32',
        'Census_PrimaryDiskTypeName':                           'category',
        'Census_SystemVolumeTotalCapacity':                     'float32',
        'Census_HasOpticalDiskDrive':                           'int8',
        'Census_TotalPhysicalRAM':                              'float32',
        'Census_ChassisTypeName':                               'category',
        'Census_InternalPrimaryDiagonalDisplaySizeInInches':    'float16',
        'Census_InternalPrimaryDisplayResolutionHorizontal':    'float16',
        'Census_InternalPrimaryDisplayResolutionVertical':      'float16',
        'Census_PowerPlatformRoleName':                         'category',
        'Census_InternalBatteryType':                           'category',
        'Census_InternalBatteryNumberOfCharges':                'float32',
        'Census_OSVersion':                                     'category',
        'Census_OSArchitecture':                                'category',
        'Census_OSBranch':                                      'category',
        'Census_OSBuildNumber':                                 'int16',
        'Census_OSBuildRevision':                               'int32',
        'Census_OSEdition':                                     'category',
        'Census_OSSkuName':                                     'category',
        'Census_OSInstallTypeName':                             'category',
        'Census_OSInstallLanguageIdentifier':                   'float16',
        'Census_OSUILocaleIdentifier':                          'int16',
        'Census_OSWUAutoUpdateOptionsName':                     'category',
        'Census_IsPortableOperatingSystem':                     'int8',
        'Census_GenuineStateName':                              'category',
        'Census_ActivationChannel':                             'category',
        'Census_IsFlightingInternal':                           'float16',
        'Census_IsFlightsDisabled':                             'float16',
        'Census_FlightRing':                                    'category',
        'Census_ThresholdOptIn':                                'float16',
        'Census_FirmwareManufacturerIdentifier':                'float16',
        'Census_FirmwareVersionIdentifier':                     'float32',
        'Census_IsSecureBootEnabled':                           'int8',
        'Census_IsWIMBootEnabled':                              'float16',
        'Census_IsVirtualDevice':                               'float16',
        'Census_IsTouchEnabled':                                'int8',
        'Census_IsPenCapable':                                  'int8',
        'Census_IsAlwaysOnAlwaysConnectedCapable':              'float16',
        'Wdft_IsGamer':                                         'float16',
        'Wdft_RegionIdentifier':                                'float16',
        'HasDetections':                                        'int8'
        }

nrows =4000000
numerics = ['int8', 'int16', 'int32', 'int64', 'float16', 'float32', 'float64']
numerical_columns = [c for c,v in dtypes.items() if v in numerics]
categorical_columns = [c for c,v in dtypes.items() if v not in numerics]
print("设置变量参数")
retained_columns = numerical_columns + categorical_columns
train = pd.read_csv('train.csv',
                    nrows = nrows,
                    usecols = retained_columns,
                    dtype=dtypes)
print("读取训练数据完成")

retained_columns += ['MachineIdentifier']
retained_columns.remove('HasDetections')
test = pd.read_csv('test.csv',
                   usecols = retained_columns,
                   dtype=dtypes)
print("读取测试数据完成")
indexer = {}
for col in categorical_columns:
    _, indexer[col] = pd.factorize(train[col])
for col in categorical_columns:
    if col == 'MachineIdentifier': continue
    train[col] = indexer[col].get_indexer(train[col])
    test[col] = indexer[col].get_indexer(test[col])
print("编码转化完成")

train = reduce_mem_usage(train)
test = reduce_mem_usage(test)
print("降内存完成")

target = train['HasDetections']
del train['HasDetections']
del train['MachineIdentifier']

imp = Imputer(missing_values='NaN', strategy='mean')
X_train, X_test, Y_train, Y_test = train_test_split(train, target, test_size=0.2, random_state=0)

X_train = imp.fit_transform(X_train)
X_test = imp.fit_transform(X_test)
sc = StandardScaler()
X_train_std = sc.fit_transform(X_train)
X_test_std = sc.fit_transform(X_test)
print("数据分割完成")
logreg = LogisticRegression(C=1)
logreg.fit(X_train_std, Y_train)
print("训练完成")
prepro = logreg.predict_proba(X_test_std)
acc = logreg.score(X_test_std,Y_test)
print("准确率:",str(acc))



idname=test['MachineIdentifier']
del test['MachineIdentifier']
test=imp.fit_transform(test)
test_std=sc.fit_transform(test)
print("测试数据处理完成")
prepro = logreg.predict_proba(test_std)

sub_df = pd.DataFrame({'MachineIdentifier':idname })
print("预测完成")
sub_df["HasDetections"] = list(prepro[:,1])
sub_df.to_csv('Submission.csv',index=False)
print("写入完成")
print(123)

</code></pre>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">可以优化的地方</h3>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">1数据上</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">##数据进行降维，特征的相关性检验，<br/>
##因为特征有很大一部分是标签类特征所以在编码转化的时候需要注意，探索编码转化的方式<br/>
##归一化活着标准化等<br/>
##或者只是用部分特征，选择部分特征来训练，从实际问题上对特征进行整合<br/>
##数据分布情况</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">2模型上</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">##主要是模型的参数，先不考虑本模型的适不适用，模型主要的参数需要改善的有<br/>
##使用那种训练方法，c值的大小正则化，<br/>
##对数据增加权重，数据的分布情况</p>
</div><center style='display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden'>---%0Alayout%3A%20%20%20%20%20post%0Atitle%3A%20%20%20%20%20%20kaggle%E7%AB%9E%E8%B5%9B%E6%80%BB%E7%BB%93%E5%88%86%E6%9E%90%EF%BC%88%E6%B2%A1%E6%9C%89%E5%8F%96%E5%BE%97%E5%BE%88%E5%A5%BD%E7%9A%84%E5%90%8D%E6%AC%A1%EF%BC%89%0Asubtitle%3A%20%20%0Adate%3A%20%20%20%20%20%20%202018-12-14%0Aauthor%3A%20%20%20%20%20%E9%AB%98%E5%BA%86%E4%B8%9C%0Aheader-img%3A%20img%2Fceshi.jpg%0Acatalog%3A%20true%0Atags%3A%0A%20%20%20%20-%20python%0A%20%20%20%20-%20%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B%0A%20%20%20%20-%20%E6%95%B0%E6%8D%AE%E5%88%86%E8%A7%A3%0A%20%20%20%20-%20%E5%9B%9E%E5%BD%92%0A%20%20%20%20%0A---%0A%0A%0A%23%20%E5%BE%AE%E8%BD%AF%E6%81%B6%E6%84%8F%E6%94%BB%E5%87%BB%E9%A2%84%E6%B5%8B%0A%E5%BE%AE%E8%BD%AF%E7%9A%84%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E9%9B%86%E7%BB%99%E5%87%BA%E7%94%B5%E8%84%91%E7%9A%84%E7%89%B9%E5%BE%81%E4%BF%A1%E6%81%AF%E5%8C%85%E6%8B%AC%E7%BC%96%E5%8F%B7%E7%89%88%E6%9C%AC%E7%AD%89%E7%BB%99%E5%87%BA%E6%98%AF%E5%90%A6%E5%8F%97%E6%94%BB%E5%87%BB%E7%9A%84%E6%A0%87%E7%AD%BE%EF%BC%8C%0A%0A%E9%80%9A%E8%BF%87%E8%BF%99%E4%BA%9B%E6%95%B0%E6%8D%AE%E8%AE%AD%E7%BB%83%E4%B8%80%E4%B8%AA%E6%A8%A1%E5%9E%8B%E5%8F%AF%E4%BB%A5%E9%A2%84%E6%B5%8B%E7%94%B5%E8%84%91%E6%98%AF%E5%90%A6%E4%BC%9A%E6%94%B6%E5%88%B0%E6%94%BB%E5%87%BB%E3%80%82%E8%BF%99%E6%98%AF%E9%A2%98%E7%9B%AE%E8%A6%81%E6%B1%82%EF%BC%8C%0A%0A%E8%AF%84%E5%88%A4%E6%A0%87%E5%87%86%E6%98%AFRoc%E6%9B%B2%E7%BA%BF%E9%9D%A2%E7%A7%AF%EF%BC%8C%E8%BE%93%E5%87%BA%E7%B1%BB%E5%88%AB%E6%A6%82%E7%8E%87%E3%80%82%0A%0A%0A%0A%23%23%20%E8%AE%B0%E5%BD%95%E6%88%91%E6%95%B2%E4%BB%A3%E7%A0%81%E5%92%8C%E6%80%9D%E8%B7%AF%E8%BF%87%E7%A8%8B%E5%92%8C%E6%80%BB%E7%BB%93%0A%0A%E9%A6%96%E5%85%88%E6%AD%A3%E5%AF%B9%E6%95%B0%E6%8D%AE%E9%9B%86%E7%AC%AC%E4%B8%80%E6%AD%A5%E8%A6%81%E5%81%9A%E7%9A%84%E4%BA%8B%E5%AF%B9%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E5%88%86%E6%9E%90%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B%EF%BC%8C%E5%88%86%E6%9E%90%E6%95%B0%E6%8D%AE%E7%9A%84%0A%0A%E6%97%B6%E5%80%99%E5%8F%91%E7%8E%B0%E6%95%B0%E6%8D%AE%E4%B8%AD%E6%9C%89%E5%BE%88%E5%A4%A7%E4%B8%80%E9%83%A8%E5%88%86%E6%A0%87%E7%AD%BE%E9%87%8F%EF%BC%8C%E5%9E%8B%E5%8F%B7%E9%87%8F%E7%AD%89%EF%BC%8C%E8%BF%99%E4%BA%9B%E9%87%8F%E5%BF%85%E9%A1%BB%E7%BB%8F%E8%BF%87%E7%BC%96%E7%A0%81%E8%BD%AC%E5%8C%96%EF%BC%8C%E6%89%8D%0A%0A%E8%83%BD%E8%AE%A9%E6%A8%A1%E5%9E%8B%E8%AF%86%E5%88%AB%EF%BC%8C%E6%95%B0%E6%8D%AE%E4%B8%AD%E6%9C%89%E5%BE%88%E5%A4%9A%E7%A9%BA%E5%80%BC%E6%88%91%E9%80%89%E6%8B%A9%E5%A1%AB%E5%85%85%E6%96%B9%E6%B3%95%E6%98%AF%E7%94%A8%E5%9D%87%E5%80%BC%E6%9D%A5%E5%A1%AB%EF%BC%8C%EF%BC%88%E8%AF%95%E4%BA%86%E5%85%B6%E4%BB%96%E7%9A%84%0A%0A%E9%83%BD%E8%A1%A8%E7%8E%B0%E4%B8%80%E8%88%AC%E5%90%A7%EF%BC%89%E3%80%82%0A%0A%E6%A8%A1%E5%9E%8B%E6%88%91%E9%80%89%E6%8B%A9%E4%BA%86%E7%BD%97%E8%BE%91%E5%9B%9E%E5%BD%92%EF%BC%8C%E5%9B%9E%E5%BD%92%E6%9C%89%E4%B8%A4%E4%B8%AA%E5%8F%82%E6%95%B0%E4%B8%80%E4%B8%AA%E6%98%AF%E8%AE%AD%E7%BB%83%E7%AE%97%E6%B3%95%E4%B8%80%E4%B8%AA%E6%98%AF%E6%AD%A3%E5%88%99%E5%8C%96%E7%B3%BB%E6%95%B0%EF%BC%8C%0A%0A%E6%88%91%E9%80%89%E6%8B%A9%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E7%AE%97%E6%B3%95%E6%AD%A3%E5%88%99%E7%B3%BB%E6%95%B0%E6%98%AF1%EF%BC%88%E4%B8%8D%E6%98%AF%E5%BE%88%E7%90%86%E6%83%B3%E7%9A%84%E7%B3%BB%E6%95%B0%EF%BC%89%0A%0A%23%20%E4%B8%8A%E4%BB%A3%E7%A0%81%0A%0A%E4%BB%A5%E4%B8%8B%E6%98%AF%E6%88%91%E7%9A%84%E4%BB%A3%E7%A0%81%EF%BC%8C%E4%BB%A3%E7%A0%81%E6%9C%89%E7%82%B9%E7%B3%99%E8%AE%AD%E7%BB%83%E5%A4%A7%E6%A6%82%E9%9C%80%E8%A6%81%E4%B8%80%E4%B8%AA%E5%B0%8F%E6%97%B6%E5%B7%A6%E5%8F%B3%EF%BC%8C%E6%88%91%E7%9C%8B%E4%BA%86%E6%8E%92%E5%90%8D%E7%AC%AC%E4%B8%80%E7%9A%84%0A%0ARoc%E5%80%BC%E6%98%AF69%25%EF%BC%8C%E6%88%91%E7%9A%84ROc%E6%98%AF65%25%E6%9C%89%E5%B7%AE%E8%B7%9D%EF%BC%8C%0A%0A%E6%B3%A8%E9%87%8A%E5%BE%88%E8%AF%A6%E7%BB%86%0A%0A%60%60%60%0Adef%20reduce_mem_usage(df%2C%20verbose%3DTrue)%3A%23%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96%E5%87%BD%E6%95%B0%0A%20%20%20%20numerics%20%3D%20%5B'int16'%2C%20'int32'%2C%20'int64'%2C%20'float16'%2C%20'float32'%2C%20'float64'%5D%0A%20%20%20%20start_mem%20%3D%20df.memory_usage().sum()%20%2F%201024**2%0A%20%20%20%20for%20col%20in%20df.columns%3A%0A%20%20%20%20%20%20%20%20col_type%20%3D%20df%5Bcol%5D.dtypes%0A%20%20%20%20%20%20%20%20if%20col_type%20in%20numerics%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20c_min%20%3D%20df%5Bcol%5D.min()%0A%20%20%20%20%20%20%20%20%20%20%20%20c_max%20%3D%20df%5Bcol%5D.max()%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20str(col_type)%5B%3A3%5D%20%3D%3D%20'int'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20c_min%20%3E%20np.iinfo(np.int8).min%20and%20c_max%20%3C%20np.iinfo(np.int8).max%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df%5Bcol%5D%20%3D%20df%5Bcol%5D.astype(np.int8)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20c_min%20%3E%20np.iinfo(np.int16).min%20and%20c_max%20%3C%20np.iinfo(np.int16).max%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df%5Bcol%5D%20%3D%20df%5Bcol%5D.astype(np.int16)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20c_min%20%3E%20np.iinfo(np.int32).min%20and%20c_max%20%3C%20np.iinfo(np.int32).max%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df%5Bcol%5D%20%3D%20df%5Bcol%5D.astype(np.int32)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20c_min%20%3E%20np.iinfo(np.int64).min%20and%20c_max%20%3C%20np.iinfo(np.int64).max%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df%5Bcol%5D%20%3D%20df%5Bcol%5D.astype(np.int64)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20c_min%20%3E%20np.finfo(np.float16).min%20and%20c_max%20%3C%20np.finfo(np.float16).max%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df%5Bcol%5D%20%3D%20df%5Bcol%5D.astype(np.float16)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20c_min%20%3E%20np.finfo(np.float32).min%20and%20c_max%20%3C%20np.finfo(np.float32).max%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df%5Bcol%5D%20%3D%20df%5Bcol%5D.astype(np.float32)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df%5Bcol%5D%20%3D%20df%5Bcol%5D.astype(np.float64)%0A%20%20%20%20end_mem%20%3D%20df.memory_usage().sum()%20%2F%201024**2%0A%20%20%20%20if%20verbose%3A%20print('Mem.%20usage%20decreased%20to%20%7B%3A5.2f%7D%20Mb%20(%7B%3A.1f%7D%25%20reduction)'.format(end_mem%2C%20100%20*%20(start_mem%20-%20end_mem)%20%2F%20start_mem))%0A%20%20%20%20return%20df%0A%0A%0A%0Aimport%20pandas%20as%20pd%0Afrom%20sklearn.linear_model%20import%20LogisticRegression%0Aimport%20numpy%20as%20np%0Afrom%20sklearn.cross_validation%20import%20train_test_split%0Afrom%20sklearn.preprocessing%20import%20StandardScaler%0Afrom%20sklearn.preprocessing%20import%20Imputer%0A%0A%0Adtypes%20%3D%20%7B%0A%20%20%20%20%20%20%20%20'MachineIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'ProductName'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'EngineVersion'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'AppVersion'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'AvSigVersion'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'IsBeta'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int8'%2C%0A%20%20%20%20%20%20%20%20'RtpStateBitfield'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'IsSxsPassiveMode'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int8'%2C%0A%20%20%20%20%20%20%20%20'DefaultBrowsersIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'AVProductStatesIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float32'%2C%0A%20%20%20%20%20%20%20%20'AVProductsInstalled'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'AVProductsEnabled'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'HasTpm'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int8'%2C%0A%20%20%20%20%20%20%20%20'CountryIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int16'%2C%0A%20%20%20%20%20%20%20%20'CityIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float32'%2C%0A%20%20%20%20%20%20%20%20'OrganizationIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'GeoNameIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'LocaleEnglishNameIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int8'%2C%0A%20%20%20%20%20%20%20%20'Platform'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Processor'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'OsVer'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'OsBuild'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int16'%2C%0A%20%20%20%20%20%20%20%20'OsSuite'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int16'%2C%0A%20%20%20%20%20%20%20%20'OsPlatformSubRelease'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'OsBuildLab'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'SkuEdition'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'IsProtected'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'AutoSampleOptIn'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int8'%2C%0A%20%20%20%20%20%20%20%20'PuaMode'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'SMode'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'IeVerIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'SmartScreen'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Firewall'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'UacLuaenable'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float32'%2C%0A%20%20%20%20%20%20%20%20'Census_MDC2FormFactor'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_DeviceFamily'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_OEMNameIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_OEMModelIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float32'%2C%0A%20%20%20%20%20%20%20%20'Census_ProcessorCoreCount'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_ProcessorManufacturerIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_ProcessorModelIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_ProcessorClass'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_PrimaryDiskTotalCapacity'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float32'%2C%0A%20%20%20%20%20%20%20%20'Census_PrimaryDiskTypeName'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_SystemVolumeTotalCapacity'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float32'%2C%0A%20%20%20%20%20%20%20%20'Census_HasOpticalDiskDrive'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int8'%2C%0A%20%20%20%20%20%20%20%20'Census_TotalPhysicalRAM'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float32'%2C%0A%20%20%20%20%20%20%20%20'Census_ChassisTypeName'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_InternalPrimaryDiagonalDisplaySizeInInches'%3A%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_InternalPrimaryDisplayResolutionHorizontal'%3A%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_InternalPrimaryDisplayResolutionVertical'%3A%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_PowerPlatformRoleName'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_InternalBatteryType'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_InternalBatteryNumberOfCharges'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float32'%2C%0A%20%20%20%20%20%20%20%20'Census_OSVersion'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_OSArchitecture'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_OSBranch'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_OSBuildNumber'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int16'%2C%0A%20%20%20%20%20%20%20%20'Census_OSBuildRevision'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int32'%2C%0A%20%20%20%20%20%20%20%20'Census_OSEdition'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_OSSkuName'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_OSInstallTypeName'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_OSInstallLanguageIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_OSUILocaleIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int16'%2C%0A%20%20%20%20%20%20%20%20'Census_OSWUAutoUpdateOptionsName'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_IsPortableOperatingSystem'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int8'%2C%0A%20%20%20%20%20%20%20%20'Census_GenuineStateName'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_ActivationChannel'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_IsFlightingInternal'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_IsFlightsDisabled'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_FlightRing'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'category'%2C%0A%20%20%20%20%20%20%20%20'Census_ThresholdOptIn'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_FirmwareManufacturerIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_FirmwareVersionIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float32'%2C%0A%20%20%20%20%20%20%20%20'Census_IsSecureBootEnabled'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int8'%2C%0A%20%20%20%20%20%20%20%20'Census_IsWIMBootEnabled'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_IsVirtualDevice'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Census_IsTouchEnabled'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int8'%2C%0A%20%20%20%20%20%20%20%20'Census_IsPenCapable'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int8'%2C%0A%20%20%20%20%20%20%20%20'Census_IsAlwaysOnAlwaysConnectedCapable'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Wdft_IsGamer'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'Wdft_RegionIdentifier'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'float16'%2C%0A%20%20%20%20%20%20%20%20'HasDetections'%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'int8'%0A%20%20%20%20%20%20%20%20%7D%0A%0Anrows%20%3D4000000%0Anumerics%20%3D%20%5B'int8'%2C%20'int16'%2C%20'int32'%2C%20'int64'%2C%20'float16'%2C%20'float32'%2C%20'float64'%5D%0Anumerical_columns%20%3D%20%5Bc%20for%20c%2Cv%20in%20dtypes.items()%20if%20v%20in%20numerics%5D%0Acategorical_columns%20%3D%20%5Bc%20for%20c%2Cv%20in%20dtypes.items()%20if%20v%20not%20in%20numerics%5D%0Aprint(%22%E8%AE%BE%E7%BD%AE%E5%8F%98%E9%87%8F%E5%8F%82%E6%95%B0%22)%0Aretained_columns%20%3D%20numerical_columns%20%2B%20categorical_columns%0Atrain%20%3D%20pd.read_csv('train.csv'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20nrows%20%3D%20nrows%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20usecols%20%3D%20retained_columns%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dtype%3Ddtypes)%0Aprint(%22%E8%AF%BB%E5%8F%96%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%88%90%22)%0A%0Aretained_columns%20%2B%3D%20%5B'MachineIdentifier'%5D%0Aretained_columns.remove('HasDetections')%0Atest%20%3D%20pd.read_csv('test.csv'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20usecols%20%3D%20retained_columns%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dtype%3Ddtypes)%0Aprint(%22%E8%AF%BB%E5%8F%96%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%88%90%22)%0Aindexer%20%3D%20%7B%7D%0Afor%20col%20in%20categorical_columns%3A%0A%20%20%20%20_%2C%20indexer%5Bcol%5D%20%3D%20pd.factorize(train%5Bcol%5D)%0Afor%20col%20in%20categorical_columns%3A%0A%20%20%20%20if%20col%20%3D%3D%20'MachineIdentifier'%3A%20continue%0A%20%20%20%20train%5Bcol%5D%20%3D%20indexer%5Bcol%5D.get_indexer(train%5Bcol%5D)%0A%20%20%20%20test%5Bcol%5D%20%3D%20indexer%5Bcol%5D.get_indexer(test%5Bcol%5D)%0Aprint(%22%E7%BC%96%E7%A0%81%E8%BD%AC%E5%8C%96%E5%AE%8C%E6%88%90%22)%0A%0Atrain%20%3D%20reduce_mem_usage(train)%0Atest%20%3D%20reduce_mem_usage(test)%0Aprint(%22%E9%99%8D%E5%86%85%E5%AD%98%E5%AE%8C%E6%88%90%22)%0A%0Atarget%20%3D%20train%5B'HasDetections'%5D%0Adel%20train%5B'HasDetections'%5D%0Adel%20train%5B'MachineIdentifier'%5D%0A%0Aimp%20%3D%20Imputer(missing_values%3D'NaN'%2C%20strategy%3D'mean')%0AX_train%2C%20X_test%2C%20Y_train%2C%20Y_test%20%3D%20train_test_split(train%2C%20target%2C%20test_size%3D0.2%2C%20random_state%3D0)%0A%0AX_train%20%3D%20imp.fit_transform(X_train)%0AX_test%20%3D%20imp.fit_transform(X_test)%0Asc%20%3D%20StandardScaler()%0AX_train_std%20%3D%20sc.fit_transform(X_train)%0AX_test_std%20%3D%20sc.fit_transform(X_test)%0Aprint(%22%E6%95%B0%E6%8D%AE%E5%88%86%E5%89%B2%E5%AE%8C%E6%88%90%22)%0Alogreg%20%3D%20LogisticRegression(C%3D1)%0Alogreg.fit(X_train_std%2C%20Y_train)%0Aprint(%22%E8%AE%AD%E7%BB%83%E5%AE%8C%E6%88%90%22)%0Aprepro%20%3D%20logreg.predict_proba(X_test_std)%0Aacc%20%3D%20logreg.score(X_test_std%2CY_test)%0Aprint(%22%E5%87%86%E7%A1%AE%E7%8E%87%3A%22%2Cstr(acc))%0A%0A%0A%0Aidname%3Dtest%5B'MachineIdentifier'%5D%0Adel%20test%5B'MachineIdentifier'%5D%0Atest%3Dimp.fit_transform(test)%0Atest_std%3Dsc.fit_transform(test)%0Aprint(%22%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%AE%8C%E6%88%90%22)%0Aprepro%20%3D%20logreg.predict_proba(test_std)%0A%0Asub_df%20%3D%20pd.DataFrame(%7B'MachineIdentifier'%3Aidname%20%7D)%0Aprint(%22%E9%A2%84%E6%B5%8B%E5%AE%8C%E6%88%90%22)%0Asub_df%5B%22HasDetections%22%5D%20%3D%20list(prepro%5B%3A%2C1%5D)%0Asub_df.to_csv('Submission.csv'%2Cindex%3DFalse)%0Aprint(%22%E5%86%99%E5%85%A5%E5%AE%8C%E6%88%90%22)%0Aprint(123)%0A%0A%60%60%60%0A%0A%23%23%23%20%E5%8F%AF%E4%BB%A5%E4%BC%98%E5%8C%96%E7%9A%84%E5%9C%B0%E6%96%B9%0A%23%23%23%23%201%E6%95%B0%E6%8D%AE%E4%B8%8A%0A%23%23%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E9%99%8D%E7%BB%B4%EF%BC%8C%E7%89%B9%E5%BE%81%E7%9A%84%E7%9B%B8%E5%85%B3%E6%80%A7%E6%A3%80%E9%AA%8C%EF%BC%8C%0A%23%23%E5%9B%A0%E4%B8%BA%E7%89%B9%E5%BE%81%E6%9C%89%E5%BE%88%E5%A4%A7%E4%B8%80%E9%83%A8%E5%88%86%E6%98%AF%E6%A0%87%E7%AD%BE%E7%B1%BB%E7%89%B9%E5%BE%81%E6%89%80%E4%BB%A5%E5%9C%A8%E7%BC%96%E7%A0%81%E8%BD%AC%E5%8C%96%E7%9A%84%E6%97%B6%E5%80%99%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%EF%BC%8C%E6%8E%A2%E7%B4%A2%E7%BC%96%E7%A0%81%E8%BD%AC%E5%8C%96%E7%9A%84%E6%96%B9%E5%BC%8F%0A%23%23%E5%BD%92%E4%B8%80%E5%8C%96%E6%B4%BB%E7%9D%80%E6%A0%87%E5%87%86%E5%8C%96%E7%AD%89%0A%23%23%E6%88%96%E8%80%85%E5%8F%AA%E6%98%AF%E7%94%A8%E9%83%A8%E5%88%86%E7%89%B9%E5%BE%81%EF%BC%8C%E9%80%89%E6%8B%A9%E9%83%A8%E5%88%86%E7%89%B9%E5%BE%81%E6%9D%A5%E8%AE%AD%E7%BB%83%EF%BC%8C%E4%BB%8E%E5%AE%9E%E9%99%85%E9%97%AE%E9%A2%98%E4%B8%8A%E5%AF%B9%E7%89%B9%E5%BE%81%E8%BF%9B%E8%A1%8C%E6%95%B4%E5%90%88%0A%23%23%E6%95%B0%E6%8D%AE%E5%88%86%E5%B8%83%E6%83%85%E5%86%B5%0A%23%23%23%23%202%E6%A8%A1%E5%9E%8B%E4%B8%8A%0A%23%23%E4%B8%BB%E8%A6%81%E6%98%AF%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%8F%82%E6%95%B0%EF%BC%8C%E5%85%88%E4%B8%8D%E8%80%83%E8%99%91%E6%9C%AC%E6%A8%A1%E5%9E%8B%E7%9A%84%E9%80%82%E4%B8%8D%E9%80%82%E7%94%A8%EF%BC%8C%E6%A8%A1%E5%9E%8B%E4%B8%BB%E8%A6%81%E7%9A%84%E5%8F%82%E6%95%B0%E9%9C%80%E8%A6%81%E6%94%B9%E5%96%84%E7%9A%84%E6%9C%89%0A%23%23%E4%BD%BF%E7%94%A8%E9%82%A3%E7%A7%8D%E8%AE%AD%E7%BB%83%E6%96%B9%E6%B3%95%EF%BC%8Cc%E5%80%BC%E7%9A%84%E5%A4%A7%E5%B0%8F%E6%AD%A3%E5%88%99%E5%8C%96%EF%BC%8C%0A%23%23%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%8A%A0%E6%9D%83%E9%87%8D%EF%BC%8C%E6%95%B0%E6%8D%AE%E7%9A%84%E5%88%86%E5%B8%83%E6%83%85%E5%86%B5%0A%0A</center></en-note>]]></content><created>20181217T104505Z</created><updated>20181217T111434Z</updated><note-attributes><author>1286670639@qq.com</author><source>desktop.mac</source><reminder-order>0</reminder-order><content-class>yinxiang.markdown</content-class></note-attributes></note>
</en-export>
